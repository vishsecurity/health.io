<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wellness Dashboard - Vishal Chaudhary</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=SF+Pro+Rounded:wght@400;600&display=swap');

* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: 'SF Pro Rounded', sans-serif;
  background: #f0f2f5;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  color: #333;
}

header { font-size: 2rem; font-weight: 600; margin: 2rem 0; color: #4a90e2; }

.timer-container {
  position: relative;
  width: 250px;
  height: 250px;
  border-radius: 50%;
  background: #f0f2f5;
  box-shadow: 8px 8px 15px #d1d9e6, -8px -8px 15px #ffffff;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 1.5rem;
}

.circle {
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  background: conic-gradient(#4a90e2 0% 0%, #d1d9e6 0% 100%);
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 2rem;
  font-weight: 600;
  color: #4a90e2;
  user-select: none;
}

.controls { display: flex; gap: 1rem; margin-bottom: 2rem; }
button {
  padding: 0.7rem 1.5rem;
  font-size: 1rem;
  font-weight: 600;
  border: none;
  border-radius: 12px;
  background: #f0f2f5;
  box-shadow: 5px 5px 10px #d1d9e6, -5px -5px 10px #ffffff;
  cursor: pointer;
  transition: 0.2s;
}
button:hover { box-shadow: inset 5px 5px 10px #d1d9e6, inset -5px -5px 10px #ffffff; }

.stats { text-align: center; margin-top: 1rem; }
.stats table { margin: auto; border-collapse: collapse; }
th, td { padding: 0.5rem 1rem; border-bottom: 1px solid #ddd; }

input[type=file] { margin-bottom: 1rem; }

.heatmap-dashboard { max-width: 800px; margin: 2rem auto; }
.heatmap-row { display: grid; grid-template-columns: repeat(31, 1fr); gap: 2px; margin-bottom: 4px; }
.heatmap-row div { width: 100%; height: 18px; border-radius: 4px; transition: 0.2s; }
.legend { display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap; }
.legend-item { display: flex; align-items: center; gap: 0.3rem; }
.legend-color { width: 18px; height: 18px; border-radius: 4px; display: inline-block; }
.legend-color.water { background-color: rgba(74,144,226,0.7); }
.legend-color.sleep { background-color: rgba(34,193,195,0.7); }
.legend-color.cycling { background-color: rgba(255,140,0,0.7); }

footer { font-size: 0.9rem; color: #777; margin: 2rem 0; }
</style>
</head>
<body>

<header>Wellness Dashboard</header>

<!-- Pomodoro Timer -->
<div class="timer-container">
  <div class="circle" id="timerCircle">25:00</div>
</div>
<div class="controls">
  <button id="startBtn">Start</button>
  <button id="pauseBtn">Pause</button>
  <button id="resetBtn">Reset</button>
</div>

<!-- GPX File Upload & Stats -->
<input type="file" id="fileInput" accept=".gpx" />
<div class="stats" id="statsOutput">
  <p>No GPX file loaded yet.</p>
</div>

<!-- Yearly Heatmaps -->
<div class="heatmap-dashboard">
  <h2>Yearly Activity Heatmap</h2>
  
  <div class="legend">
    <span class="legend-item"><span class="legend-color water"></span>Water (liters)</span>
    <span class="legend-item"><span class="legend-color sleep"></span>Sleep (hours)</span>
    <span class="legend-item"><span class="legend-color cycling"></span>Cycling (km)</span>
  </div>

  <h3>üíß Water</h3>
  <div id="waterHeatmap"></div>
  
  <h3>üõèÔ∏è Sleep</h3>
  <div id="sleepHeatmap"></div>
  
  <h3>üö¥ Cycling</h3>
  <div id="cyclingHeatmap"></div>
</div>

<footer>¬© 2025 Vishal Chaudhary</footer>

<script>
// ===== Pomodoro Timer =====
let timerDuration = 25*60; // 25 minutes
let timer = timerDuration;
let interval = null;
const timerCircle = document.getElementById('timerCircle');

function updateTimerDisplay() {
  const mins = Math.floor(timer/60);
  const secs = timer%60;
  timerCircle.textContent = `${String(mins).padStart(2,'0')}:${String(secs).padStart(2,'0')}`;
  const percent = ((timerDuration-timer)/timerDuration)*100;
  timerCircle.style.background = `conic-gradient(#4a90e2 0% ${percent}%, #d1d9e6 ${percent}% 100%)`;
}

document.getElementById('startBtn').addEventListener('click', ()=>{
  if(!interval){
    interval = setInterval(()=>{
      if(timer>0){ timer--; updateTimerDisplay(); }
      else { clearInterval(interval); interval=null; alert("Pomodoro complete!"); }
    },1000);
  }
});

document.getElementById('pauseBtn').addEventListener('click', ()=>{
  clearInterval(interval); interval=null;
});

document.getElementById('resetBtn').addEventListener('click', ()=>{
  clearInterval(interval); interval=null; timer=timerDuration; updateTimerDisplay();
});

updateTimerDisplay();

// ===== GPX File Handling =====
document.getElementById('fileInput').addEventListener('change', handleFile);
const statsOutput = document.getElementById('statsOutput');

function handleFile(event){
  const file = event.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = e=>parseGPX(e.target.result);
  reader.readAsText(file);
}

function parseGPX(gpxText){
  const parser = new DOMParser();
  const xmlDoc = parser.parseFromString(gpxText,"application/xml");
  const trkpts = xmlDoc.getElementsByTagName("trkpt");
  if(trkpts.length===0){ statsOutput.innerHTML="<p>No track points found.</p>"; return; }

  let totalDistance=0, startTime, endTime, prevLat, prevLon;
  for(let i=0;i<trkpts.length;i++){
    const lat=parseFloat(trkpts[i].getAttribute("lat"));
    const lon=parseFloat(trkpts[i].getAttribute("lon"));
    const timeElem = trkpts[i].getElementsByTagName("time")[0];
    const time = timeElem?new Date(timeElem.textContent):null;
    if(i===0 && time) startTime=time;
    if(i===trkpts.length-1 && time) endTime=time;
    if(i>0) totalDistance+=haversine(prevLat,prevLon,lat,lon);
    prevLat=lat; prevLon=lon;
  }
  const duration=(endTime && startTime)?(endTime-startTime)/1000:0;
  const distanceKm=totalDistance/1000;
  const avgSpeed=duration>0?distanceKm/(duration/3600):0;

  statsOutput.innerHTML=`
    <table>
      <tr><th>Distance</th><td>${distanceKm.toFixed(2)} km</td></tr>
      <tr><th>Duration</th><td>${formatTime(duration)}</td></tr>
      <tr><th>Avg Speed</th><td>${avgSpeed.toFixed(2)} km/h</td></tr>
      ${startTime?`<tr><th>Start</th><td>${startTime.toLocaleString()}</td></tr>`:''}
      ${endTime?`<tr><th>End</th><td>${endTime.toLocaleString()}</td></tr>`:''}
    </table>
  `;
}

function haversine(lat1,lon1,lat2,lon2){
  const R=6371e3;
  const œÜ1=lat1*Math.PI/180, œÜ2=lat2*Math.PI/180;
  const ŒîœÜ=(lat2-lat1)*Math.PI/180, ŒîŒª=(lon2-lon1)*Math.PI/180;
  const a=Math.sin(ŒîœÜ/2)**2 + Math.cos(œÜ1)*Math.cos(œÜ2)*Math.sin(ŒîŒª/2)**2;
  const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));
  return R*c;
}

function formatTime(seconds){
  const hrs=Math.floor(seconds/3600);
  const mins=Math.floor((seconds%3600)/60);
  const secs=Math.floor(seconds%60);
  return `${hrs}h ${mins}m ${secs}s`;
}

// ===== Yearly Heatmaps =====
const daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];
function generateMonthlyHeatmap(containerId,dailyData,color){
  const container=document.getElementById(containerId);
  container.innerHTML='';
  let dayIndex=0;
  for(let month=0;month<12;month++){
    const monthRow=document.createElement('div'); monthRow.className='heatmap-row';
    for(let day=0;day<daysInMonth[month];day++){
      const box=document.createElement('div');
      const value=dailyData[dayIndex]||0;
      const intensity=Math.min(1,value/10);
      box.style.backgroundColor=`rgba(${color.r},${color.g},${color.b},${intensity})`;
      box.title=`Day ${day+1}, Month ${month+1}: ${value}`;
      monthRow.appendChild(box);
      dayIndex++;
    }
    container.appendChild(monthRow);
  }
}

// Dummy yearly data
const waterData = Array.from({length:365},()=>Math.floor(Math.random()*10));
const sleepData = Array.from({length:365},()=>Math.floor(Math.random()*10));
const cyclingData = Array.from({length:365},()=>Math.floor(Math.random()*10));

// Generate heatmaps
generateMonthlyHeatmap('waterHeatmap', waterData, {r:74,g:144,b:226});
generateMonthlyHeatmap('sleepHeatmap', sleepData, {r:34,g:193,b:195});
generateMonthlyHeatmap('cyclingHeatmap', cyclingData, {r:255,g:140,b:0});

</script>

</body>
</html>
