<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Health Dashboard</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --sleep-color: #007AFF;
  --cycling-color: #FF9500;
  --water-color: #5AC8FA;
  --bg-primary: #F5F5F7;
  --bg-secondary: #FFFFFF;
  --text-primary: #1D1D1F;
  --text-secondary: #86868B;
  --border-color: rgba(0, 0, 0, 0.08);
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.04);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
  --shadow-lg: 0 12px 48px rgba(0, 0, 0, 0.12);
  --radius-sm: 12px;
  --radius-md: 16px;
  --radius-lg: 24px;
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

@media (prefers-color-scheme: dark) {
  :root {
    --bg-primary: #000000;
    --bg-secondary: #1C1C1E;
    --text-primary: #F5F5F7;
    --text-secondary: #86868B;
    --border-color: rgba(255, 255, 255, 0.1);
    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
    --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
    --shadow-lg: 0 12px 48px rgba(0, 0, 0, 0.5);
  }
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.6;
  overflow-x: hidden;
}

.app-container {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

header {
  background: rgba(255, 255, 255, 0.8);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border-bottom: 1px solid var(--border-color);
  position: sticky;
  top: 0;
  z-index: 1000;
  padding: 20px 0;
}

@media (prefers-color-scheme: dark) {
  header {
    background: rgba(28, 28, 30, 0.8);
  }
}

h1 {
  text-align: center;
  font-size: 34px;
  font-weight: 700;
  letter-spacing: -0.5px;
  color: var(--text-primary);
}

.tab-nav {
  display: flex;
  justify-content: center;
  gap: 8px;
  padding: 16px 20px;
  background: var(--bg-primary);
}

.tab-button {
  padding: 10px 24px;
  border: none;
  background: transparent;
  color: var(--text-secondary);
  font-size: 15px;
  font-weight: 500;
  cursor: pointer;
  border-radius: var(--radius-sm);
  transition: var(--transition);
  position: relative;
}

.tab-button:hover {
  color: var(--text-primary);
  background: rgba(0, 0, 0, 0.04);
}

@media (prefers-color-scheme: dark) {
  .tab-button:hover {
    background: rgba(255, 255, 255, 0.1);
  }
}

.tab-button.active {
  color: var(--text-primary);
  font-weight: 600;
}

.tab-button.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 24px;
  right: 24px;
  height: 2px;
  background: var(--sleep-color);
  border-radius: 2px;
}

.tab-content {
  display: none;
  flex: 1;
  padding: 40px 20px;
  animation: fadeIn 0.4s ease;
}

.tab-content.active {
  display: flex;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.status-container {
  max-width: 1200px;
  margin: 0 auto;
  width: 100%;
}

.circles-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 24px;
  margin-bottom: 40px;
}

.circle-card {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: 32px;
  text-align: center;
  box-shadow: var(--shadow-md);
  transition: var(--transition);
  border: 1px solid var(--border-color);
}

.circle-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
}

.circle-wrapper {
  position: relative;
  width: 180px;
  height: 180px;
  margin: 0 auto 20px;
}

.circle-svg {
  width: 100%;
  height: 100%;
  transform: rotate(-90deg);
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.08));
}

.circle-bg {
  fill: none;
  stroke: var(--border-color);
  stroke-width: 8;
}

.circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dashoffset 1s cubic-bezier(0.4, 0, 0.2, 1);
}

.circle-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 36px;
  font-weight: 700;
  letter-spacing: -1px;
}

.circle-label {
  font-size: 17px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.circle-subtitle {
  font-size: 13px;
  color: var(--text-secondary);
}

.tracker-container {
  max-width: 800px;
  margin: 0 auto;
  width: 100%;
}

.form-card {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: 32px;
  box-shadow: var(--shadow-md);
  margin-bottom: 32px;
  border: 1px solid var(--border-color);
}

.form-group {
  margin-bottom: 24px;
}

.form-label {
  display: block;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 8px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.form-input {
  width: 100%;
  padding: 14px 16px;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  font-size: 17px;
  background: var(--bg-primary);
  color: var(--text-primary);
  transition: var(--transition);
  font-family: inherit;
}

.form-input:focus {
  outline: none;
  border-color: var(--sleep-color);
  box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.1);
}

.form-input::placeholder {
  color: var(--text-secondary);
}

.button-group {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.btn {
  padding: 14px 28px;
  border: none;
  border-radius: var(--radius-sm);
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  font-family: inherit;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.btn-primary {
  background: var(--sleep-color);
  color: white;
  box-shadow: 0 2px 8px rgba(0, 122, 255, 0.3);
}

.btn-primary:hover {
  background: #0051D5;
  box-shadow: 0 4px 16px rgba(0, 122, 255, 0.4);
  transform: translateY(-1px);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-secondary {
  background: var(--bg-primary);
  color: var(--text-primary);
  border: 1px solid var(--border-color);
}

.btn-secondary:hover {
  background: var(--bg-secondary);
  border-color: var(--text-secondary);
}

.data-table {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow-md);
  border: 1px solid var(--border-color);
}

table {
  width: 100%;
  border-collapse: collapse;
}

thead {
  background: var(--bg-primary);
  border-bottom: 1px solid var(--border-color);
}

th {
  padding: 16px;
  text-align: left;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

td {
  padding: 16px;
  border-top: 1px solid var(--border-color);
  font-size: 15px;
}

tr:hover {
  background: var(--bg-primary);
}

footer {
  text-align: center;
  padding: 32px 20px;
  color: var(--text-secondary);
  font-size: 13px;
  border-top: 1px solid var(--border-color);
  margin-top: auto;
}

.empty-state {
  text-align: center;
  padding: 60px 20px;
  color: var(--text-secondary);
}

.empty-state-icon {
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.3;
}

.empty-state-text {
  font-size: 17px;
  margin-bottom: 8px;
}

.empty-state-subtext {
  font-size: 13px;
}

@media (max-width: 768px) {
  h1 {
    font-size: 28px;
  }

  .circles-grid {
    grid-template-columns: 1fr;
    gap: 16px;
  }

  .form-card {
    padding: 24px;
  }

  .button-group {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    justify-content: center;
  }

  table {
    font-size: 13px;
  }

  th, td {
    padding: 12px 8px;
  }
}

/* File input styling */
.file-input-wrapper {
  position: relative;
  overflow: hidden;
  display: inline-block;
  width: 100%;
}

.file-input-wrapper input[type=file] {
  position: absolute;
  left: -9999px;
}

.file-input-label {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 14px 16px;
  border: 2px dashed var(--border-color);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: var(--transition);
  background: var(--bg-primary);
  color: var(--text-secondary);
  font-size: 15px;
}

.file-input-label:hover {
  border-color: var(--sleep-color);
  color: var(--sleep-color);
  background: rgba(0, 122, 255, 0.04);
}

.file-name {
  margin-top: 8px;
  font-size: 13px;
  color: var(--text-secondary);
}

/* Loading animation */
@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: white;
  animation: spin 0.6s linear infinite;
}
</style>
</head>
<body>

<div class="app-container">
  <header>
    <h1>Health Dashboard</h1>
  </header>

  <nav class="tab-nav">
    <button class="tab-button active" onclick="openTab(event, 'status')">Status</button>
    <button class="tab-button" onclick="openTab(event, 'tracker')">Tracker</button>
  </nav>

  <!-- Status Tab -->
  <div id="status" class="tab-content active">
    <div class="status-container">
      <div class="circles-grid">
        <div class="circle-card">
          <div class="circle-wrapper">
            <svg class="circle-svg" viewBox="0 0 200 200">
              <circle class="circle-bg" cx="100" cy="100" r="90"></circle>
              <circle class="circle-progress" id="sleep-circle" cx="100" cy="100" r="90" 
                      stroke="var(--sleep-color)" 
                      stroke-dasharray="565.48" 
                      stroke-dashoffset="565.48"></circle>
            </svg>
            <div class="circle-text" id="sleep-value" style="color: var(--sleep-color)">0h</div>
          </div>
          <div class="circle-label">Sleep</div>
          <div class="circle-subtitle">Total hours tracked</div>
        </div>

        <div class="circle-card">
          <div class="circle-wrapper">
            <svg class="circle-svg" viewBox="0 0 200 200">
              <circle class="circle-bg" cx="100" cy="100" r="90"></circle>
              <circle class="circle-progress" id="cycling-circle" cx="100" cy="100" r="90" 
                      stroke="var(--cycling-color)" 
                      stroke-dasharray="565.48" 
                      stroke-dashoffset="565.48"></circle>
            </svg>
            <div class="circle-text" id="cycling-value" style="color: var(--cycling-color)">0km</div>
          </div>
          <div class="circle-label">Cycling</div>
          <div class="circle-subtitle">Total distance</div>
        </div>

        <div class="circle-card">
          <div class="circle-wrapper">
            <svg class="circle-svg" viewBox="0 0 200 200">
              <circle class="circle-bg" cx="100" cy="100" r="90"></circle>
              <circle class="circle-progress" id="water-circle" cx="100" cy="100" r="90" 
                      stroke="var(--water-color)" 
                      stroke-dasharray="565.48" 
                      stroke-dashoffset="565.48"></circle>
            </svg>
            <div class="circle-text" id="water-value" style="color: var(--water-color)">0L</div>
          </div>
          <div class="circle-label">Water</div>
          <div class="circle-subtitle">Total intake</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tracker Tab -->
  <div id="tracker" class="tab-content">
    <div class="tracker-container">
      <div class="form-card">
        <div class="form-group">
          <label class="form-label" for="date">Date</label>
          <input class="form-input" type="date" id="date" required>
        </div>

        <div class="form-group">
          <label class="form-label" for="sleep">Sleep (hours)</label>
          <input class="form-input" type="number" id="sleep" min="0" max="12" step="0.1" placeholder="8.0">
        </div>

        <div class="form-group">
          <label class="form-label" for="cycling">Cycling (km)</label>
          <input class="form-input" type="number" id="cycling" min="0" step="0.1" placeholder="10.5">
        </div>

        <div class="form-group">
          <label class="form-label" for="water">Water (litres)</label>
          <input class="form-input" type="number" id="water" min="0" step="0.1" placeholder="2.5">
        </div>

        <div class="form-group">
          <label class="form-label">GPX File (Optional)</label>
          <div class="file-input-wrapper">
            <input type="file" id="gpx-file" accept=".gpx" onchange="updateFileName(this)">
            <label for="gpx-file" class="file-input-label">
              📁 Choose GPX file
            </label>
          </div>
          <div class="file-name" id="file-name"></div>
        </div>

        <div class="button-group">
          <button class="btn btn-primary" onclick="addEntry()">Add Entry</button>
          <button class="btn btn-secondary" onclick="exportGPX()">Export GPX</button>
          <button class="btn btn-secondary" onclick="importGPX()">Import GPX</button>
          <input type="file" id="import-gpx" accept=".gpx" style="display: none;">
        </div>
      </div>

      <div class="data-table">
        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Sleep (h)</th>
              <th>Cycling (km)</th>
              <th>Water (L)</th>
            </tr>
          </thead>
          <tbody id="data-tbody">
            <tr>
              <td colspan="4">
                <div class="empty-state">
                  <div class="empty-state-icon">📊</div>
                  <div class="empty-state-text">No data yet</div>
                  <div class="empty-state-subtext">Add your first entry to get started</div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <footer>
    © Vishal Chaudhary. All Rights Reserved.
  </footer>
</div>

<script>
let healthData = [];
const maxValues = { sleep: 100, cycling: 500, water: 50 };
const circumference = 2 * Math.PI * 90;

// Load data from localStorage
function loadData() {
  const stored = localStorage.getItem('healthData');
  if (stored) {
    try {
      healthData = JSON.parse(stored);
      updateTable();
      updateCircles();
    } catch (e) {
      console.error('Error loading data:', e);
    }
  }
}

// Save data to localStorage
function saveData() {
  localStorage.setItem('healthData', JSON.stringify(healthData));
}

// Tab switching
function openTab(evt, tabName) {
  document.querySelectorAll('.tab-content').forEach(content => {
    content.classList.remove('active');
  });
  document.querySelectorAll('.tab-button').forEach(button => {
    button.classList.remove('active');
  });
  
  document.getElementById(tabName).classList.add('active');
  evt.currentTarget.classList.add('active');
}

// Update circle progress
function updateCircle(id, value, max) {
  const circle = document.getElementById(id + '-circle');
  const valueEl = document.getElementById(id + '-value');
  const percent = Math.min(value / max, 1);
  const offset = circumference * (1 - percent);
  
  circle.style.strokeDashoffset = offset;
  
  if (id === 'sleep') {
    valueEl.textContent = value.toFixed(1) + 'h';
  } else if (id === 'cycling') {
    valueEl.textContent = value.toFixed(1) + 'km';
  } else if (id === 'water') {
    valueEl.textContent = value.toFixed(1) + 'L';
  }
}

// Update all circles
function updateCircles() {
  let totals = { sleep: 0, cycling: 0, water: 0 };
  
  healthData.forEach(entry => {
    totals.sleep += entry.sleep;
    totals.cycling += entry.cycling;
    totals.water += entry.water;
  });
  
  updateCircle('sleep', totals.sleep, maxValues.sleep);
  updateCircle('cycling', totals.cycling, maxValues.cycling);
  updateCircle('water', totals.water, maxValues.water);
}

// Update table
function updateTable() {
  const tbody = document.getElementById('data-tbody');
  
  if (healthData.length === 0) {
    tbody.innerHTML = `
      <tr>
        <td colspan="4">
          <div class="empty-state">
            <div class="empty-state-icon">📊</div>
            <div class="empty-state-text">No data yet</div>
            <div class="empty-state-subtext">Add your first entry to get started</div>
          </div>
        </td>
      </tr>
    `;
    return;
  }
  
  tbody.innerHTML = healthData.map(entry => `
    <tr>
      <td>${entry.date}</td>
      <td>${entry.sleep.toFixed(1)}</td>
      <td>${entry.cycling.toFixed(2)}</td>
      <td>${entry.water.toFixed(1)}</td>
    </tr>
  `).join('');
}

// Haversine distance calculation
function haversine(lat1, lon1, lat2, lon2) {
  const R = 6371;
  const toRad = x => x * Math.PI / 180;
  const dLat = toRad(lat2 - lat1);
  const dLon = toRad(lon2 - lon1);
  const a = Math.sin(dLat / 2) ** 2 + 
            Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * 
            Math.sin(dLon / 2) ** 2;
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return R * c;
}

// Add entry
function addEntry() {
  const date = document.getElementById('date').value;
  let sleep = parseFloat(document.getElementById('sleep').value) || 0;
  let cycling = parseFloat(document.getElementById('cycling').value) || 0;
  let water = parseFloat(document.getElementById('water').value) || 0;
  
  if (!date) {
    alert('Please enter a date');
    return;
  }
  
  const gpxFile = document.getElementById('gpx-file').files[0];
  
  if (gpxFile) {
    const reader = new FileReader();
    reader.onload = function(e) {
      const parser = new DOMParser();
      const xmlDoc = parser.parseFromString(e.target.result, 'text/xml');
      const trkpts = xmlDoc.getElementsByTagNameNS('*', 'trkpt');
      
      if (trkpts.length > 1) {
        let distance = 0;
        for (let i = 1; i < trkpts.length; i++) {
          const lat1 = parseFloat(trkpts[i - 1].getAttribute('lat'));
          const lon1 = parseFloat(trkpts[i - 1].getAttribute('lon'));
          const lat2 = parseFloat(trkpts[i].getAttribute('lat'));
          const lon2 = parseFloat(trkpts[i].getAttribute('lon'));
          
          if (!isNaN(lat1) && !isNaN(lon1) && !isNaN(lat2) && !isNaN(lon2)) {
            distance += haversine(lat1, lon1, lat2, lon2);
          }
        }
        cycling += distance;
        alert(`GPX processed: ${distance.toFixed(2)} km added`);
      }
      
      saveEntry(date, sleep, cycling, water);
    };
    reader.readAsText(gpxFile);
  } else {
    saveEntry(date, sleep, cycling, water);
  }
}

// Save entry
function saveEntry(date, sleep, cycling, water) {
  healthData.push({ date, sleep, cycling, water });
  saveData();
  updateTable();
  updateCircles();
  
  // Clear form
  document.getElementById('date').value = '';
  document.getElementById('sleep').value = '';
  document.getElementById('cycling').value = '';
  document.getElementById('water').value = '';
  document.getElementById('gpx-file').value = '';
  document.getElementById('file-name').textContent = '';
}

// Export GPX
function exportGPX() {
  if (healthData.length === 0) {
    alert('No data to export');
    return;
  }
  
  let gpx = `<?xml version="1.0" encoding="UTF-8"?>\n<gpx version="1.1" creator="HealthDashboard" xmlns="http://www.topografix.com/GPX/1/1">\n`;
  
  healthData.forEach(entry => {
    gpx += `  <trk>\n    <name>${entry.date}</name>\n    <desc>Sleep: ${entry.sleep}h, Cycling: ${entry.cycling}km, Water: ${entry.water}L</desc>\n    <trkseg>\n      <trkpt lat="0" lon="0"><ele>0</ele><time>${entry.date}T00:00:00Z</time></trkpt>\n    </trkseg>\n  </trk>\n`;
  });
  
  gpx += `</gpx>`;
  
  const blob = new Blob([gpx], { type: 'application/gpx+xml' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'health_data_export.gpx';
  a.click();
}

// Import GPX
function importGPX() {
  document.getElementById('import-gpx').click();
}

document.getElementById('import-gpx').addEventListener('change', function() {
  const file = this.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      const parser = new DOMParser();
      const xmlDoc = parser.parseFromString(e.target.result, 'text/xml');
      const trks = xmlDoc.getElementsByTagNameNS('*', 'trk');
      
      for (let i = 0; i < trks.length; i++) {
        const name = trks[i].getElementsByTagNameNS('*', 'name')[0]?.textContent || 'Unknown';
        const desc = trks[i].getElementsByTagNameNS('*', 'desc')[0]?.textContent || '';
        const sleep = parseFloat(desc.match(/Sleep: ([0-9.]+)/)?.[1] || 0);
        const cycling = parseFloat(desc.match(/Cycling: ([0-9.]+)/)?.[1] || 0);
        const water = parseFloat(desc.match(/Water: ([0-9.]+)/)?.[1] || 0);
        
        healthData.push({ date: name, sleep, cycling, water });
      }
      
      saveData();
      updateTable();
      updateCircles();
      alert('Data imported successfully!');
    };
    reader.readAsText(file);
  }
});

// Update file name display
function updateFileName(input) {
  const fileNameEl = document.getElementById('file-name');
  if (input.files && input.files[0]) {
    fileNameEl.textContent = '📄 ' + input.files[0].name;
  } else {
    fileNameEl.textContent = '';
  }
}

// Set today's date as default
document.getElementById('date').valueAsDate = new Date();

// Initialize
loadData();
</script>

</body>
</html>
